include(FetchContent)

if(USE_EXTERNAL_ALL)
  option(USE_EXTERNAL_JSON "Use JSON from an external source" ON)
  option(USE_EXTERNAL_B64 "Use an External Base64 Library" ON)
  option(USE_EXTERNAL_CLI11 "Use an external CLI11 instance" ON)
elseif(USE_FETCHCONTENT_ALL)
  option(USE_FETCHCONTENT_JSON "Use JSON from a fetched source" ON)
  option(USE_FETCHCONTENT_B64 "Use a fetched Base64 Library" ON)
  option(USE_FETCHCONTENT_CLI11 "Use a fetched CLI11 instance" ON)
else()
  option(USE_EXTERNAL_JSON "Use JSON from an external source" OFF)
  option(USE_EXTERNAL_B64 "Use an External Base64 Library" OFF)
  option(USE_EXTERNAL_CLI11 "Use an external CLI11 instance" OFF)

  option(USE_FETCHCONTENT_JSON "Use JSON from a fetched source" OFF)
  option(USE_FETCHCONTENT_B64 "Use a fetched Base64 Library" OFF)
  option(USE_FETCHCONTENT_CLI11 "Use a fetched CLI11 instance" OFF)
endif()

if(USE_EXTERNAL_JSON)
  find_package(jsonlib 3.2.0 REQUIRED)
elseif(USE_FETCHCONTENT_JSON)
  FetchContent_Declare(json
      GIT_REPOSITORY https://github.com/nlohmann/json
      GIT_TAG v3.11.2
  )
  FetchContent_MakeAvailable(json)
else()
  set(JSON_BuildTests OFF CACHE INTERNAL "")
  add_subdirectory(jsonlib)
  include_directories(jsonlib/include)
endif()

if(USE_EXTERNAL_B64)
  find_package(b64lib REQUIRED)
elseif(USE_FETCHCONTENT_B64)
else()
  include_directories(b64lib/include)
endif()

if(USE_EXTERNAL_CLI11)
  find_package(CLI11 REQUIRED)
elseif(USE_FETCHCONTENT_CLI11)
else()
  add_subdirectory(CLI11)
  include_directories(CLI11/include)
endif()